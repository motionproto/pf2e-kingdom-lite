{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "title": "Player Skill Action Schema",
  "description": "Schema for kingdom actions that use player character skills",
  "required": ["id", "name", "category", "skills", "effects"],
  "properties": {
    "id": {
      "type": "string",
      "description": "Unique identifier for the action"
    },
    "name": {
      "type": "string", 
      "description": "Display name of the action"
    },
    "category": {
      "type": "string",
      "enum": ["stability", "military", "borders", "urban", "foreign", "economic"],
      "description": "Category of the action"
    },
    "description": {
      "type": "string",
      "description": "Detailed description of what the action does"
    },
    "availability": {
      "type": "string",
      "description": "When or where this action can be performed"
    },
    "skills": {
      "type": "array",
      "description": "Player skills that can be used for this action",
      "items": {
        "type": "object",
        "required": ["skill", "description"],
        "properties": {
          "skill": {
            "type": "string",
            "enum": [
              "acrobatics", "arcana", "athletics", "crafting", "deception",
              "diplomacy", "intimidation", "medicine", "nature", "occultism",
              "performance", "religion", "society", "stealth", "survival",
              "thievery", "warfare-lore", "mercantile-lore"
            ]
          },
          "description": {
            "type": "string",
            "description": "How this skill applies to the action"
          },
          "circumstanceBonus": {
            "type": "integer",
            "description": "Circumstance bonus when using this skill"
          }
        }
      }
    },
    "failureCausesUnrest": {
      "type": "boolean",
      "default": false,
      "description": "Whether critical failures cause +1 Unrest"
    },
    "cost": {
      "type": "object",
      "description": "Resources required to attempt this action",
      "properties": {
        "gold": {"type": "integer"},
        "resources": {
          "type": "object",
          "properties": {
            "lumber": {"type": "integer"},
            "stone": {"type": "integer"},
            "ore": {"type": "integer"},
            "food": {"type": "integer"},
            "luxuries": {"type": "integer"}
          }
        }
      }
    },
    "requirements": {
      "type": "array",
      "description": "Requirements to perform this action",
      "items": {
        "type": "object",
        "properties": {
          "type": {
            "type": "string",
            "enum": ["structure", "settlement", "hex", "ally", "troop", "worksite"]
          },
          "details": {
            "type": "string"
          }
        }
      }
    },
    "limitations": {
      "type": "object",
      "properties": {
        "oncePerTurn": {
          "type": "boolean",
          "default": false
        },
        "maxParticipants": {
          "type": "integer",
          "description": "Maximum number of PCs that can participate"
        },
        "endOfTurnOnly": {
          "type": "boolean",
          "default": false
        }
      }
    },
    "coordinatedEffort": {
      "type": "object",
      "description": "Special rules for Coordinated Effort",
      "properties": {
        "available": {
          "type": "boolean",
          "default": false
        },
        "bonus": {
          "type": "integer",
          "default": 1
        }
      }
    },
    "proficiencyScaling": {
      "type": "object",
      "description": "How proficiency affects the action",
      "properties": {
        "trained": {"type": "string"},
        "expert": {"type": "string"},
        "master": {"type": "string"},
        "legendary": {"type": "string"}
      }
    },
    "effects": {
      "type": "object",
      "required": ["criticalSuccess", "success", "failure", "criticalFailure"],
      "properties": {
        "criticalSuccess": {
          "type": "object",
          "properties": {
            "description": {"type": "string"},
            "unrest": {"type": "integer"},
            "resources": {
              "type": "object",
              "properties": {
                "gold": {"type": "integer"},
                "lumber": {"type": "integer"},
                "stone": {"type": "integer"},
                "ore": {"type": "integer"},
                "food": {"type": "integer"},
                "luxuries": {"type": "integer"}
              }
            },
            "special": {"type": "string"}
          }
        },
        "success": {
          "type": "object",
          "properties": {
            "description": {"type": "string"},
            "unrest": {"type": "integer"},
            "resources": {
              "type": "object",
              "properties": {
                "gold": {"type": "integer"},
                "lumber": {"type": "integer"},
                "stone": {"type": "integer"},
                "ore": {"type": "integer"},
                "food": {"type": "integer"},
                "luxuries": {"type": "integer"}
              }
            },
            "special": {"type": "string"}
          }
        },
        "failure": {
          "type": "object",
          "properties": {
            "description": {"type": "string"},
            "unrest": {"type": "integer"},
            "resources": {
              "type": "object",
              "properties": {
                "gold": {"type": "integer"},
                "lumber": {"type": "integer"},
                "stone": {"type": "integer"},
                "ore": {"type": "integer"},
                "food": {"type": "integer"},
                "luxuries": {"type": "integer"}
              }
            },
            "special": {"type": "string"}
          }
        },
        "criticalFailure": {
          "type": "object",
          "properties": {
            "description": {"type": "string"},
            "unrest": {"type": "integer"},
            "resources": {
              "type": "object",
              "properties": {
                "gold": {"type": "integer"},
                "lumber": {"type": "integer"},
                "stone": {"type": "integer"},
                "ore": {"type": "integer"},
                "food": {"type": "integer"},
                "luxuries": {"type": "integer"}
              }
            },
            "special": {"type": "string"}
          }
        }
      }
    }
  }
}
